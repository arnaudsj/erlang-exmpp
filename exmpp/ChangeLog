2007-02-06  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* c_src/uni_data.c, c_src/uni_norm.c, c_src/stringprep_uni_data.h,
	c_src/stringprep_uni_norm.h: Renamed as real headers.

	* c_src/stringprep_drv.c: Internal name of the driver changed to
	`exmpp_stringprep_erl'.

	* c_src/exmpp_stringprep_drv.c, c_src/exmpp_stringprep_drv.c,
	c_src/Makefile.am, src/stringprep.erl, priv/lib/Makefile.am: Prefixed
	`stringprep_drv' with `exmpp_' to avoid conflicts with ejabberd's own
	stringprep_drv. This permits exmpp to coexist with ejabberd.

2007-01-09  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* configure.ac: Next branch will be 0.7.

2007-01-09  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* configure.ac: Fixed the name of a variable.

2007-01-04  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* configure.ac: Head is now the future 0.6 branch. Dropped
	`EXMPP_BUILD_ID'. Debug is disabled by default when
	`EXMPP_RELEASE_DATE' is set and enabled otherwise. Comments translated
	in english.

	* include/exmpp.hrl: Add `jabber:iq:privacy', `jabber:iq:roster' and
	`urn:ietf:params:xml:ns:xmpp-session' namespaces.

	* doc/Makefile.am: Clean stylesheet.css if it was copied at compile
	time.

	* src/exmpp_factory.erl: Add functions to make common pubsub stanzas.

	* src/exmpp_jlib.erl: Add functions to convert #jid{} to string and
	the other way around. Style.

	* testsuite/test.sh: Fixed portability issues with sed(1) and head(1).

	* c_src/xmpp_ns.h.in, c_src/xmpp_attrs.h.in, c_src/xmpp_names.h.in:
	Added pubsub-related namespaces, element names and attribute names.

	* c_src/Makefile.am: Fixed CPPFLAGS for expat_drv (EXPAT_CPPFLAS was
	missing).

2006-10-30  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* priv/lib/Makefile.am: Copies of stringprep_drv.so,
	tls_drv.so and iconv_erl.so are useless, because they're not tested by
	the current testsuite.

	* include/exmpp.hrl: Corrections in comments.

	* src/exmpp_jlib.erl, src/jlib.erl, src/Emakefile.ini,
	src/Makefile.am: As we did with `exmpp_xml' and `xml', we split
	`exmpp_jlib' in `exmpp_jlib' and `jlib' to separate the old code with
	the new one. Because this module didn't received a lot of
	modifications and testing, we took this opportunity to import the last
	version of `jlib' from today's ejabberd repository.

	* src/exmpp_xml.erl, configure.ac: Add a compile-time flag to enable a
	workaround for `erl_ddll' reference count bug.

	* configure.ac, c_src/Makefile.am, ebin/Makefile.am: Add a flag to
	disable the compatibility modules.

	* ebin/exmpp.app.in, ebin/exmpp.appup.in: Application file and upgrade
	file update.

	* configure.ac, src/Emakefile.in, ebin/exmpp.app.in: If compatibility
	modules are disabled, don't build/list them.

2006-10-12  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* src/exmpp_xml.erl (start_parser): Unload driver if an error occurs
	with options handling.
	(stop_parser): Don't catch exceptions with port_close/1; the caller is
	responsible for catching them if he wants.

2006-10-05  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* configure.ac: Préparation de la release 0.5.3.

	* ebin/exmpp.appup.in: Instructions de mise à jour depuis la version
	0.5.2.

	* src/exmpp_xml.erl (stop_parser): Avant de décharger la librairie, on
	vérifie que port_close a fonctionné (en `catch'ant l'exception). Ça
	évite de trop décrémenter le comptage de référence sur la librairie.

2006-09-28  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* configure.ac: Préparation de la release 0.5.2.

	* c_src/expat_drv.c (current_tree_finished): Correction d'un autre
	leak du même type que celui du 2006-09-25.

	* ebin/exmpp.app.in: Utilisation de @VERSION@ au lieu de
	@PACKAGE_VERSION@ pour rester cohérent.

	* ebin/exmpp.appup.in: Utilisation de @VERSION@ au lieu d'une version
	en dur. Mise à jour pour prendre en compte une upgrade/downgrade entre
	la version 0.5.2 et la version 0.5.1.

2006-09-26  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* src/exmpp_xml.erl (reload_driver): Suppression de la fonction, on ne
	peut pas s'en servir en l'état.
	(stop_parser): Après le port_close/1, on décharge la librairie.

	* src/exmpp_factory.erl (legacy_auth_request_with_user): Nouvelle
	fonction pour préciser le nom d'utilisateur dans la requête
	d'authentification. Correction de l'exportation de la fonction.

2006-09-25  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* configure.ac: Préparation de la release 0.5.1.

	* c_src/expat_drv.c: Ajout d'une commande pour retourner la revision
	du fichier.
	(expat_drv_control): Correction d'un memory leak.

	* src/exmpp_xml.erl: Ajout d'une fonction pour récupérer la revision
	du port driver `expat_drv'.

	* configure.ac, ebin/exmpp.appup, ebin/Makefile.am: Ajout du fichier
	de mise à jour.

2006-09-11  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.5.0.

	* configure.ac: Mise à jour de la version.

2006-09-11  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* m4/expat.m4: Corrections de bug dans les flags passés au compilateur
	si l'utilisateur précise --with-expat=DIR.

2006-09-07  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* ebin/charon.app.in: On ajoute $Id$ pour l'id de l'application.

2006-09-04  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.4.7.

	* src/exmpp_factory.erl: Correction de la documentation.

	* src/exmpp_xml.erl (load_driver): Correction d'un bug avec le
	chargement de la librairie. En fait, il faut charger la librairie
	autant de fois que open_port est appelé car erl_ddll maintient un
	comptage de référence. C'est pour cette raison qu'avec les version
	précédentes de `exmpp_xml', tous les parsers instanciés étaient
	détruits avec le premier appel à `stop_parser'.

	* c_src/expat_drv.c (expat_drv_stop): Le `return' final est
	complètement inutile.
	(expat_drv_control): En cas de commande inconnue, on retourne `{error,
	badarg}' au lieu de `badarg'.

2006-08-31  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.4.6.

	* include/exmpp.hrl: Ajout du namespace utilisé pour les erreurs au
	niveau stream.

	* src/exmpp_factory.erl (stream_error): Nouvelle fonction pour générer
	les erreurs au niveau stream.

2006-08-29  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.4.5.

	* configure.ac: Ajout de flags de compilation Erlang pour avoir un
	maximum de warnings.

	* src/xml.erl: Correction de la documenation pour que les fonctions
	obsolètes pointent vers `exmpp_xml'.
	(get_cdata, remove_cdata): Rajout de deux fonctions qui avaient été
	supprimées avec la séparation `exmpp_xml'/`xml'.

	* src/exmpp_xml.erl: Correction de la documentation.
	(replace_child): Nouvelle fonction pour remplacer le fils d'un élément
	XML.
	(xmlnselement_to_xmlelement, xmlnsattributes_to_xmlattributes2):
	Correction de plusieurs warnings.

	* ebin/exmpp.app.in: Mise à jour de la liste des modules ; il manquait
	`xml'.

2006-08-16  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.4.4.

	* include/exmpp.hrl, src/exmpp_xml.erl (document_fragment_to_list):
	Support rudimentaire des Processing Instructions pour permettre à
	l'appelant de générer `<?xml version='1.0' ?>' par exemple.

	* include/exmpp.hrl: Ajout des namespaces pour les demandes de
	compression, de TLS et de SASL.

	* src/exmpp_factory.erl: Ajout de fonctions pour générer des stanzas
	de négociations de TLS et de la compression.

	* src/exmpp_xml.erl (xmlelement_to_xmlnselement,
	xmlelement_to_xmlnselement_and_ns_tables): Ajout de fonctions pour
	convertir les anciens tuples vers les nouveaux formats.
	(xmlnselement_to_xmlelement): Correction d'un bug où le cas d'un
	namespace sous forme de chaîne de caractères (au lieu d'atome) n'était
	pas géré.

	* src/exmpp.erl, src/iconv.erl, src/ejabberd_zlib.erl, src/tls.erl,
	src/exmpp_xml.erl, src/stringprep.erl: On supprime la fonction
	exmpp:app/0 qui n'a pas de sens et on utilise le nom `exmpp' en dur.
	Ça permet l'utilisation d'exmpp dans une application, c'est magique.

	* ebin/Makefile.am: Le fichier d'application `exmpp.app' n'était pas
	installé, c'est corrigé.

	* ebin/exmpp.app.in: Correction d'une erreur de syntaxe. Ajout des
	modules manquants à la liste.

2006-08-04  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.4.3.

	* src/ejabberd_zlib.erl, c_src/ejabberd_zlib_drv.c, configure.ac,
	src/Makefile.am, c_src/Makefile.am, ebin/Makefile.am: Import du module
	ejabberd_zlib d'ejabberd.

	* configure.ac: La gestion de relase empruntait encore le nom de
	libcalimero.

	* src/exmpp_xmlstream.erl: Corrections de la documentation.

	* testsuite/check_coverity.erl: On n'inclut pas exmpp.hrl.

	* testsuite/Makefile.am: style(9).

2006-07-19  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.4.2.

	* src/exmpp_xmlstream.erl: Correction de la documentation qui faisait
	encore référence à l'option `rootdepth' du parser XML (au lieu de
	`root_depth').
	(parse, process_elements, process_elements2, send_events): On gère un
	nouveau callback `none' qui indique que l'appeleur de parse/2 veut
	récupérer le résultat directement (au lieu de l'envoyer à un autre
	process/une autre fonction). La documentation est mise à jour en
	conséquence.

	* src/exmpp_xml.erl: New parser option `no_root_depth' to force the
	parser to make an xmlnselement() for each tag.
	(parser_document_fragment): New function to parse an incomplete
	document; this takes advantage of the new `no_root_depth' option.

	* testsuite/check_xmlstream.erl: Updated to test the `no_callback'
	callback.

	* testsuite/Makefile.am: Added check_xmlstrea.erl to the EXTRA_DIST
	list.

	* c_src/expat_drv.c: Updated to handle the new `no_root_depth' parser
	option.

2006-07-13  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.4.1.

	* src/exmpp_factory.erl: Wrote user guide.

	* src/exmpp_jlib.erl (exchange_attrs_from_and_to_in_list,
	rename_attr_to_to_from_in_list): Fixed a bug where those functions
	were still calling `exmpp_xml:set_attribute_from_list' which has been
	renamed since.

	* testsuite/test/sh: Small change on coverity reports stylesheet.

	* doc/stylesheet.css: Changed completly the documentation graphical
	aspect.

2006-07-12  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* include/exmpp.hrl: For #xmlstreamstart and #xmlstreamend record,
	members are now #xmlnselement, #xmlelement, #xmlnsendelement or
	#xmlendelement.

	* configure.ac: Completly remove compatibility layer options.

	* src/exmpp_xml.erl, src/xml.erl: Moved pathcomponentold()
	documentation stub to `xml'.

	* src/exmpp_xmlstream.erl: Updated #xmlstreamstart and #xmlstreamend
	usage (members have changed).
	(send_event/2): Callbacks of type `process' or `gen_fsm' won't return
	an error code, remove this support.

	* c_src/expat_drv.c (expat_drv_end_element): Support for prefix and
	name as atom was never implemented for end elements; it's now done.

	* testsuite/check_coverity.erl: Completly remove compatibility layer
	options.
	(print_coverage): Generate a plain text output, not an HTML one. Also,
	use real newline characters in display, because testsuite/test.sh was
	fixed.

	* testsuite/Emakefile.in, testsuite/Makefile.am,
	testsuite/check_xmlstream.erl: Added a new test for
	`exmpp_xmlstream'.

	* testsuite/test.sh: Fixed command execution to not strip newline
	characters. Special treatment for `check_coverity' output was thus
	removed. Added a small function to convert plain text files produced
	by `check_coverity' in HTML files.

	* testsuite/check_xml_parser.erl: Fixed a testcase, now that
	c_src/expat_drv.c handles end element correctly.

	* testsuite/testsuite.erl: Print error report with Erlang to have
	output wrapped correctly.

2006-07-11  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* src/exmpp_xml.erl, src/xml.erl, src/Makefile.am, src/Emakefile.in,
	ebin/Makefile.am: Moved compatibility layer from `exmpp_xml' to
	`xml'.

	* src/xml.erl (crypt/1): Updated to reflect the original behaviour
	with binaries (it returns a list).

	* src/exmpp_xml.erl (encode_entities/1): Small optimization with
	binaries (removed a binary_to_list/1).

	* testsuite/check_xml_converters.erl: Added tests for
	encode_enities/1 and clear_endelement_tuples/1.

2006-07-10  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.4.0.

	* include/exmpp.hrl: Renamed `NS_XMPP_STANZA' to `NS_XMPP_STANZAS'.

	* src/exmpp_factory.erl: Typos.
	(legacy_auth_request/2, legacy_auth_password/4,
	legacy_auth_password_digest/4): New functions to allow the caller to
	provide its own id.
	(legacy_auth_password, legacy_auth_password_digest): Added the
	`type' attribute.
	(legacy_auth_success): Set the element's children to the empty string.
	Fixed the namespace.
	(legacy_auth_failure): Fixed the namespace.

	* src/exmpp_xml.erl: Use the ?NS_XML macro (defined in
	include/exmpp.hrl) instead of a hard-coded URL.

	* c_src/xmpp_names.h.in: Added the `jabber:iq:auth' namespace
	elements.

	* testsuite/check_factory_stream.erl: New testsuite for the module
	exmpp_factory, only for the <stream> handling part.

	* testsuite/check_factory_legacy_auth: New testsuite for the module
	exmpp_factory, only for the legacy auth part.

	* testsuite/check_xml_*.erl: Use the ?NS_XML macro (defined in
	include/exmpp.hrl) instead of a hard-coded URL.

	* doc/Makefile.am: Added files to CLEANFILES variable.

2006-07-10  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* include/exmpp.hrl: By default, element's children are now
	`undefined', not an empty list anymore.

	* src/exmpp_xmlstream.erl: style(9).

	* src/exmpp_jlib.erl: New helpers to handle common attribute
	operations. Almost every existing functions will be deprecated by new
	functions like those.

	* src/exmpp_xml.erl: Fixed some function names. Added functions
	`set_attributes/2', `append_children/2' and `set_children/2' to do
	massive modifications in one call. Added functions
	`has_attribute_in_list/2,3' and `has_attribute/2,3' to tests the
	existence of an attribute. Added `normalize_cdata_in_list/1' and
	`normalize_cdata/1' to clean character data. Added
	`set_cdata_in_list/2' and `set_cdata/2' to change character data.
	Updated documentation about the use of `undefined' for element's
	children. Fixed a few other syntax issues with the documentation.
	(parse_document): Simplified function clauses to avoid code
	duplication.
	(xmlnsattributes_to_xmlattributes2): Fixed a bug when an attribute
	namespace is `undefined'.
	(document_fragment_to_list): If element's children are `undefined', do
	not close the tag.

	* c_src/Makefile.am: Fixed EXTRA_DIST for contrib/.

	* c_src/xmpp_ns.h.in: New namespace: `jabber:iq:auth'.

	* c_src/expat_drc.c: By default, element's children are now
	`undefined', not an empty list anymore.

	* ebin/Makefile.am, src/Makefile.am, src/Emakefile.in,
	src/exmpp_factory.erl: New module; it provides a toolbox to build
	common stanzas.

	* testsuite/Makefile.am: Coverity check for `exmpp_factory'.

	* testsuite/check_xml_attribute_handlers.erl,
	testsuite/check_xml_element_handlers.erl,
	testsuite/check_xml_converters.erl, testsuite/check_xml_parser.erl,
	testsuite/check_xml_cdata_handlers.erl: Updated with new function
	names and new test cases.

	* configure.ac, Makefile.am, doc/Makefile.am: Build documentation.

	* configure.ac, src/exmpp_xml.erl: Don't use the WITH_DEPRECATED_API
	preprocessor flag to avoid headaches with edoc.

2006-07-04  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* src/exmpp_xml.erl, c_src/expat_drv.c: Before namespaces, element
	names and attributes names are encoded as atom(), they're now checked
	against a list of known values. If they're not recognized, they're
	encoded as string(). Those checks can be disabled at runtime.

	* src/exmpp_xml.erl (parse_document/1, parse_document/2): New
	functions to parse a document at once.

	* src/exmpp_xmlstream.erl (parse_element/1, parse_element/2): These
	functions now use exmpp_xml:parse_document().

	* c_src/xmpp_{ns,names,attrs}.h.in: New files that contains a list
	of known namespaces, element names and attributes names, respectively.

	* c_src/xmpp_{ns,names,attrs}.h.awk: Awk script to convert the lists
	to C headers.

2006-07-03  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* src/exmpp_xml.erl (start_parser/1, handle_options/2): Error sent
	back by the port driver were ignored, it's now corrected.

	* c_src/contrib/hashtable.h, c_src/contrib/hashtable_private.h,
	c_src/hashtable.c: Imported an hashtable implementation which is used
	by the Expat port driver.

	* c_src/Makefile.am: Add hashtable sources to the Expat port driver.

	* c_src/expat_drv.c: Namespace prefixes are now stored in an hash
	table and set correctly in xmlnselement tuples.
	(expat_drv_control): Fixed a bug where the return value of
	create_parser() was not checked correctly.

	* testsuite/check_xml_parser.erl: Updated to handle namespace prefix
	support in the port driver. Also simplified each test cases.

2006-06-29  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* configure.ac: Fixed a bug with $EMKOPTS handling.
	Removed two debugging messages. Fixed a typo with `debug_info'.

	* src/exmpp_xml.erl: The function get_path_s/2 wasn't exported; also
	it now handles old path component format.
	(remove_attribute_from_list): Rewritten this completly broken
	function.
	(xmlnselement_to_xmlelement): Now handle properly default and prefixed
	namespaces for elements and attributes.
	(xmlnselement_to_xmlelement): Support for name as atom() was not
	present in the old format, so convert them as string. Fixed a bug when
	an element doesn't have any namespace.
	(xmlnsattributes_to_xmlattributes2): Support for name as atom() was
	not present in the old format, so convert them as string.

	* src/iconv.erl, src/stringprep.erl: Fixed Erlang warnings.

	* testsuite/: More complete testsuite, with coverage checking.

	* testsuite/check_xml_converters.erl: Renamed from
	check_xml_serializer.erl to add other tests than just
	serialization.

	* ebin/Makefile.am, testsuite/Makefile.am: Every built files were not
	cleaned properly; fixed.

2006-06-28  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	The whole project uses the Autotools now.

	* include/exmpp.hrl: Add a prefix member to xmlnselement record. Add
	an xmlattr record to handle attribute (with namespace support).

	* src/exmpp_xml.erl: New API (more consistent) with better namespace
	support (even for attributes). There's a compatibility layer for the
	old API, which can be enabled by defining WITH_DEPRECATED_API at
	compile time.

	* c_src/expat_drv.c: Imporve namespace support, especially for
	attributes. Add an option to put element and attribute name as
	atom().

	* c_src/tls_drv.c (tls_drv_control): Fixed a warning about different
	types in an affectation.

	* testsuite/: Add a testsuite.
