2006-07-13  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.4.1.

	* src/exmpp_factory.erl: Wrote user guide.

	* src/exmpp_jlib.erl (exchange_attrs_from_and_to_in_list,
	rename_attr_to_to_from_in_list): Fixed a bug where those functions
	were still calling `exmpp_xml:set_attribute_from_list' which has been
	renamed since.

	* testsuite/test/sh: Small change on coverity reports stylesheet.

	* doc/stylesheet.css: Changed completly the documentation graphical
	aspect.

2006-07-12  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* include/exmpp.hrl: For #xmlstreamstart and #xmlstreamend record,
	members are now #xmlnselement, #xmlelement, #xmlnsendelement or
	#xmlendelement.

	* configure.ac: Completly remove compatibility layer options.

	* src/exmpp_xml.erl, src/xml.erl: Moved pathcomponentold()
	documentation stub to `xml'.

	* src/exmpp_xmlstream.erl: Updated #xmlstreamstart and #xmlstreamend
	usage (members have changed).
	(send_event/2): Callbacks of type `process' or `gen_fsm' won't return
	an error code, remove this support.

	* c_src/expat_drv.c (expat_drv_end_element): Support for prefix and
	name as atom was never implemented for end elements; it's now done.

	* testsuite/check_coverity.erl: Completly remove compatibility layer
	options.
	(print_coverage): Generate a plain text output, not an HTML one. Also,
	use real newline characters in display, because testsuite/test.sh was
	fixed.

	* testsuite/Emakefile.in, testsuite/Makefile.am,
	testsuite/check_xmlstream.erl: Added a new test for
	`exmpp_xmlstream'.

	* testsuite/test.sh: Fixed command execution to not strip newline
	characters. Special treatment for `check_coverity' output was thus
	removed. Added a small function to convert plain text files produced
	by `check_coverity' in HTML files.

	* testsuite/check_xml_parser.erl: Fixed a testcase, now that
	c_src/expat_drv.c handles end element correctly.

	* testsuite/testsuite.erl: Print error report with Erlang to have
	output wrapped correctly.

2006-07-11  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* src/exmpp_xml.erl, src/xml.erl, src/Makefile.am, src/Emakefile.in,
	ebin/Makefile.am: Moved compatibility layer from `exmpp_xml' to
	`xml'.

	* src/xml.erl (crypt/1): Updated to reflect the original behaviour
	with binaries (it returns a list).

	* src/exmpp_xml.erl (encode_entities/1): Small optimization with
	binaries (removed a binary_to_list/1).

	* testsuite/check_xml_converters.erl: Added tests for
	encode_enities/1 and clear_endelement_tuples/1.

2006-07-10  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	Release 0.4.0.

	* include/exmpp.hrl: Renamed `NS_XMPP_STANZA' to `NS_XMPP_STANZAS'.

	* src/exmpp_factory.erl: Typos.
	(legacy_auth_request/2, legacy_auth_password/4,
	legacy_auth_password_digest/4): New functions to allow the caller to
	provide its own id.
	(legacy_auth_password, legacy_auth_password_digest): Added the
	`type' attribute.
	(legacy_auth_success): Set the element's children to the empty string.
	Fixed the namespace.
	(legacy_auth_failure): Fixed the namespace.

	* src/exmpp_xml.erl: Use the ?NS_XML macro (defined in
	include/exmpp.hrl) instead of a hard-coded URL.

	* c_src/xmpp_names.h.in: Added the `jabber:iq:auth' namespace
	elements.

	* testsuite/check_factory_stream.erl: New testsuite for the module
	exmpp_factory, only for the <stream> handling part.

	* testsuite/check_factory_legacy_auth: New testsuite for the module
	exmpp_factory, only for the legacy auth part.

	* testsuite/check_xml_*.erl: Use the ?NS_XML macro (defined in
	include/exmpp.hrl) instead of a hard-coded URL.

	* doc/Makefile.am: Added files to CLEANFILES variable.

2006-07-10  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* include/exmpp.hrl: By default, element's children are now
	`undefined', not an empty list anymore.

	* src/exmpp_xmlstream.erl: style(9).

	* src/exmpp_jlib.erl: New helpers to handle common attribute
	operations. Almost every existing functions will be deprecated by new
	functions like those.

	* src/exmpp_xml.erl: Fixed some function names. Added functions
	`set_attributes/2', `append_children/2' and `set_children/2' to do
	massive modifications in one call. Added functions
	`has_attribute_in_list/2,3' and `has_attribute/2,3' to tests the
	existence of an attribute. Added `normalize_cdata_in_list/1' and
	`normalize_cdata/1' to clean character data. Added
	`set_cdata_in_list/2' and `set_cdata/2' to change character data.
	Updated documentation about the use of `undefined' for element's
	children. Fixed a few other syntax issues with the documentation.
	(parse_document): Simplified function clauses to avoid code
	duplication.
	(xmlnsattributes_to_xmlattributes2): Fixed a bug when an attribute
	namespace is `undefined'.
	(document_fragment_to_list): If element's children are `undefined', do
	not close the tag.

	* c_src/Makefile.am: Fixed EXTRA_DIST for contrib/.

	* c_src/xmpp_ns.h.in: New namespace: `jabber:iq:auth'.

	* c_src/expat_drc.c: By default, element's children are now
	`undefined', not an empty list anymore.

	* ebin/Makefile.am, src/Makefile.am, src/Emakefile.in,
	src/exmpp_factory.erl: New module; it provides a toolbox to build
	common stanzas.

	* testsuite/Makefile.am: Coverity check for `exmpp_factory'.

	* testsuite/check_xml_attribute_handlers.erl,
	testsuite/check_xml_element_handlers.erl,
	testsuite/check_xml_converters.erl, testsuite/check_xml_parser.erl,
	testsuite/check_xml_cdata_handlers.erl: Updated with new function
	names and new test cases.

	* configure.ac, Makefile.am, doc/Makefile.am: Build documentation.

	* configure.ac, src/exmpp_xml.erl: Don't use the WITH_DEPRECATED_API
	preprocessor flag to avoid headaches with edoc.

2006-07-04  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* src/exmpp_xml.erl, c_src/expat_drv.c: Before namespaces, element
	names and attributes names are encoded as atom(), they're now checked
	against a list of known values. If they're not recognized, they're
	encoded as string(). Those checks can be disabled at runtime.

	* src/exmpp_xml.erl (parse_document/1, parse_document/2): New
	functions to parse a document at once.

	* src/exmpp_xmlstream.erl (parse_element/1, parse_element/2): These
	functions now use exmpp_xml:parse_document().

	* c_src/xmpp_{ns,names,attrs}.h.in: New files that contains a list
	of known namespaces, element names and attributes names, respectively.

	* c_src/xmpp_{ns,names,attrs}.h.awk: Awk script to convert the lists
	to C headers.

2006-07-03  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* src/exmpp_xml.erl (start_parser/1, handle_options/2): Error sent
	back by the port driver were ignored, it's now corrected.

	* c_src/contrib/hashtable.h, c_src/contrib/hashtable_private.h,
	c_src/hashtable.c: Imported an hashtable implementation which is used
	by the Expat port driver.

	* c_src/Makefile.am: Add hashtable sources to the Expat port driver.

	* c_src/expat_drv.c: Namespace prefixes are now stored in an hash
	table and set correctly in xmlnselement tuples.
	(expat_drv_control): Fixed a bug where the return value of
	create_parser() was not checked correctly.

	* testsuite/check_xml_parser.erl: Updated to handle namespace prefix
	support in the port driver. Also simplified each test cases.

2006-06-29  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	* configure.ac: Fixed a bug with $EMKOPTS handling.
	Removed two debugging messages. Fixed a typo with `debug_info'.

	* src/exmpp_xml.erl: The function get_path_s/2 wasn't exported; also
	it now handles old path component format.
	(remove_attribute_from_list): Rewritten this completly broken
	function.
	(xmlnselement_to_xmlelement): Now handle properly default and prefixed
	namespaces for elements and attributes.
	(xmlnselement_to_xmlelement): Support for name as atom() was not
	present in the old format, so convert them as string. Fixed a bug when
	an element doesn't have any namespace.
	(xmlnsattributes_to_xmlattributes2): Support for name as atom() was
	not present in the old format, so convert them as string.

	* src/iconv.erl, src/stringprep.erl: Fixed Erlang warnings.

	* testsuite/: More complete testsuite, with coverage checking.

	* testsuite/check_xml_converters.erl: Renamed from
	check_xml_serializer.erl to add other tests than just
	serialization.

	* ebin/Makefile.am, testsuite/Makefile.am: Every built files were not
	cleaned properly; fixed.

2006-06-28  Jean-Sébastien Pédron  <js.pedron@meetic-corp.com>

	The whole project uses the Autotools now.

	* include/exmpp.hrl: Add a prefix member to xmlnselement record. Add
	an xmlattr record to handle attribute (with namespace support).

	* src/exmpp_xml.erl: New API (more consistent) with better namespace
	support (even for attributes). There's a compatibility layer for the
	old API, which can be enabled by defining WITH_DEPRECATED_API at
	compile time.

	* c_src/expat_drv.c: Imporve namespace support, especially for
	attributes. Add an option to put element and attribute name as
	atom().

	* c_src/tls_drv.c (tls_drv_control): Fixed a warning about different
	types in an affectation.

	* testsuite/: Add a testsuite.
